from sage.rings.polynomial.polynomial_gf2x import GF2X_BuildIrred_list

# M = 128
N = 1512
t = 24
n = int(N / t)
R_F = 6
R_P = 42
irred = GF(2)['x'](GF2X_BuildIrred_list(n))
F.<x> = GF(2**n, name='x', modulus = irred)

round_constants = ['0x6fcf6d895867fdb9', '0x23e7e7e6dc172d6b', '0x686ebe1d873a9185', '0x3a425b36b0c32ba8', '0x4363fb694cf95b57', '0x545ea74c82e09507', '0x52cced4b2db9eb90', '0x7dbcbc9081b645f3', '0x741d03c8f63e4edf', '0x3b32b27306d01884', '0x1216b290a38e38d4', '0x70372ce459ef43dd', '0x08fa13e4ee21d44b', '0x209166493eaff0f2', '0x004153aeda29f429', '0x71645752bcbc3743', '0x32f3d95a77d6b894', '0x28b3a72ca825511e', '0x0540b32b5bbbfd11', '0x06a273869b7d8a96', '0x484de0c0555a8225', '0x737147a371daa5ac', '0x0c981d2a6f6dcd90', '0x7dc4875920ec9d40', '0x049ef6ae9403b1c9', '0x4e7413357c5a0830', '0x0e986d4bafc59cd8', '0x3ae96397008b5116', '0x08811a9cb71a4e89', '0x550ff0fd803767fd', '0x107e59fbac284be0', '0x558b3cd93e8012d1', '0x39fe1f780101fc5d', '0x5797f2841fcacc5c', '0x7754a534cf1ba6f4', '0x457fec04cc1be2ae', '0x257ecbacbca8afc6', '0x033802859d3858aa', '0x6c1bc25040471149', '0x785ecc18e8941d8b', '0x150f6a98535436d7', '0x4278707d0ea8aede', '0x5e5b41b4ba9e4bcb', '0x4143ab802fe08800', '0x17582b2f9a861ccc', '0x2fdb13e27ec0d3d8', '0x61aadcdc699cdf1f', '0x37380affa4c960ac', '0x5cabba3b1cb8b0b5', '0x4d3613635b3b43d2', '0x63627e2c2806bb56', '0x166b88bcdf532d6d', '0x696aee7cae131f01', '0x0b56cf762fe869d4', '0x2384c93ec7b86ee0', '0x432db8080a8c31ac', '0x62deea54760f7cb9', '0x73c9ef6112ee0856', '0x12d9e859ee104ed3', '0x6d5a4c37b7d23194', '0x5b3c621467b8c9cc', '0x12f75d2874cb3434', '0x000026393037d6b1', '0x37a8ae2974e8586e', '0x7de3f4ae1b2a0e70', '0x4edb182c3c83e7c6', '0x1033b9ee74b0c8b8', '0x0dd3658036537a2a', '0x49ae7b4d34466849', '0x1ed633a5fcf5e3bd', '0x7259a0d526dd9889', '0x3a5879116ac4fae2', '0x50ffeea86bf4a650', '0x4427e74e4cbbd87a', '0x4a1d0887abf64244', '0x3bd253e6b0c85eda', '0x3d3092a52e255fb6', '0x20be5292fb6f7ba9', '0x69c27270683299a1', '0x1b7aafbc06bc927a', '0x1c08fc7128f4ae2c', '0x2524173548decea6', '0x152e944c7b1904aa', '0x38f39e4334bde99e', '0x0cb1d73b7ae79b22', '0x642768df45a41043', '0x7d900aca4a2a4781', '0x2e031743b7e4c523', '0x09651099529aa55f', '0x0b1abd771e42a16d', '0x74deab0d1b479285', '0x5341ce1a2343bb79', '0x76191e1127aa9ce7', '0x574e67153ea184a8', '0x196b633ed9f8cc8a', '0x2b6ba33abc2b9269', '0x3e10d3ccc25a5675', '0x0c33890d19678641', '0x61d7004a68976fef', '0x18dae36577757979', '0x410f775800ca8c84', '0x234ebe9d7607f650', '0x2fdefc6f311da3e9', '0x744d163e5dd20b65', '0x689a378b82f5717b', '0x2abafdff6edc2b60', '0x2b31e5046cecda9a', '0x1eb51f5bab579566', '0x66f41dbc1b9e2ff9', '0x28f5161f44eaaff5', '0x65c9736ae87bf576', '0x7e59b0d44ef2957b', '0x143ee0b83d528364', '0x074bf4f2f20f6535', '0x5133c21280d7d10a', '0x22045290c027af4e', '0x71cadbd8a266a72d', '0x1112b7cdf208aa32', '0x6a30bf87c8729924', '0x2ca7eaa1ad16cf79', '0x1534ef0223f4e481', '0x4839455578578a68', '0x40c53a15b211db92', '0x17edbfe2515bdc0c', '0x3cba195a82f254a9', '0x22db5364a5cfaa2a', '0x78db778a19b1101e', '0x32b7a4d0784b7329', '0x2cdb0812d753a1fd', '0x16cf9cdf5aaca6ee', '0x44cf8d2916166667', '0x22852b6194bc11d0', '0x736b5cd51d2fb81e', '0x5f43c7e22b8b158f', '0x78d802732da0fd78', '0x10150e32ca400e7e', '0x1e35b5f03eb4264b', '0x32eaec11fe217896', '0x1a533f327911015a', '0x24f7436b9afbe525', '0x011948fa15568823', '0x1f96f2d053b692b5', '0x1141de8a647f67a5', '0x618783f60af11036', '0x754b6a7ffcef1c9d', '0x127700681b8ec6b5', '0x5a5244b1f712be18', '0x451b50c4e24c3d87', '0x4d5ea5934f972423', '0x1f948da9a5687b05', '0x75f9a4faa4acb9ee', '0x5e8e3192eda4cfe7', '0x0e8c779ca9d9e54b', '0x255404cc4e72cb66', '0x6ee3caf56a2c2abb', '0x2d956d89f987fc6b', '0x4f21d9b4487ee5b6', '0x19ebc1d9e1d57e31', '0x7800dd316a62ddda', '0x4d8c94ce25a580c6', '0x57e016d75b97c41f', '0x3fabef7edc7128c7', '0x1f5c26f30590a3d3', '0x51e6af58e78e6079', '0x0e7e87bf2792e098', '0x5a03f6cde7c39c8e', '0x2d3bb844d5d149f8', '0x16bf635aa2f54d14', '0x3ee3dc349fb9f1c7', '0x4328e5b0967d486f', '0x587e8fe60c720787', '0x1c7e684a6b9abfba', '0x5aef0e248b6baad7', '0x29166c50d900862e', '0x7413b2be1f9dc67b', '0x4cd7b4f0decd1f2b', '0x700e4e6c87e32112', '0x3e1952cb87178014', '0x21c1332d280e349a', '0x5b75dc4eba821c12', '0x4342a7cddf15bb16', '0x3968bd09b408222f', '0x40ae0d2f3084d932', '0x5ca0e88dfb6f5869', '0x46c029aeff43a804', '0x19c1f57883b23b6b', '0x50bec453afbaa1ff', '0x1a81af5bb1f8fead', '0x43c2f0524b5916ab', '0x7e0a72d43eb1baf2', '0x5c98d335ddc4be87', '0x49361d981bcce01a', '0x7dbb86620d21ede9', '0x75a8e870a77f5c99', '0x7029346f90f9cd00', '0x6062cef719b7fef8', '0x6e1f6402f4834b31', '0x0975a53eb8c788f2', '0x4281f2c7dd349474', '0x4b967a20f9283d25', '0x0d2990f94e27f64e', '0x7d1eabc71ccceaf9', '0x4353e78d18955866', '0x7c90eb1ca4f035e0', '0x714541e0f39f68a7', '0x297c1b682c43cffc', '0x13fdf82a42e93a07', '0x028d06974e291db1', '0x747f3cec76ebd97a', '0x6f828cc920e7c15d', '0x2cd6e7beb35c1989', '0x7ccc09cc0e45d627', '0x22e949258a0f1602', '0x5cef16a4ec8680ff', '0x572a4812de74454b', '0x3a3d6e6e8054e385', '0x22955b97daacfd92', '0x591aebe85f4f01c4', '0x1fb90c072a23e2e6', '0x1120a9737cbeab5f', '0x3c9b44edfe2a89b1', '0x5c786b446c18ef59', '0x3145af4239f95bb2', '0x682c6cea70e91030', '0x7394c375e8e65565', '0x240fedfbc0c08d50', '0x0b2e008911ddddec', '0x102538b442a82f27', '0x1e6cc12686d423d3', '0x4230f79001835cb0', '0x7ba61d8839114c14', '0x5291505fe35ea8cc', '0x0fc4fe8e3ce60110', '0x74b33be1d48879b8', '0x11397156a8f9237a', '0x7ea848ffc6e810a3', '0x0dc07d166607d9d1', '0x43f31d20521ee829', '0x2c335950d92ac9eb', '0x4d16618cd7cb517d', '0x32a5a2363d0392d2', '0x6848be318a92e9b3', '0x58f1b97643c315ee', '0x1433c2970a455bb6', '0x2a56ebd6388dd3e9', '0x540e8378f7eac7fc', '0x5baef2da3dcb6290', '0x3ea52be1fc057d37', '0x1232887124c0abe8', '0x7fa2e4e7080df870', '0x4a8fa5e643d0e10a', '0x2acb98fbc0ad0f8c', '0x10ebb17aa120acf8', '0x653665030e9f7ee9', '0x18db3b8403205d63', '0x33a8a2016d1f8451', '0x57774e83dbbaa312', '0x34e65b92b31d97dc', '0x466fbfbb0d2321ff', '0x5c1bc013ebed33e4', '0x4b7e427ebdfbe90e', '0x13961bb3228b6814', '0x6d928e56cfff68f3', '0x15e1a64792940a9e', '0x0561eb02a8db5897', '0x71e92f4797ace87f', '0x16d162985178d8a0', '0x0d8d9b559161bd41', '0x67b830aacf0f601a', '0x2278c3f158d551dd', '0x6e274be753fd38d1', '0x16156e414275dfb0', '0x4b4511f954c6b4c1', '0x1704cf2db9f882f2', '0x7e00a83400ee606d', '0x4262a17591b8bcb8', '0x5320844313d3fbd8', '0x0f6dd4fe61906829', '0x074bf4b3176e6de7', '0x48779ee66a5c7ce9', '0x2a5ff0652c07501a', '0x1917f16d0fb16241', '0x099d0b139ba4fb23', '0x384ec97195a9deda', '0x765651d1ef9d2b68', '0x0a6e8047d719c780', '0x2fd9fe9f9c5b9b63', '0x0574c67d4eb76f30', '0x503ada4bc954b980', '0x6e486abd729ed402', '0x661dee003f55ec55', '0x3c27b3ff62c6c139', '0x5cdfc1129897a323', '0x1b672d97374c0e33', '0x1e5c37c0f05a1b9b', '0x4055ae574d024eb3', '0x3957f55ccc473550', '0x14846ca7102899cc', '0x7e17b561f5322a53', '0x380575cb7edbaa2f', '0x58ff6883d7e9d61f', '0x350e3cc3813d7919', '0x2ab0c48e7ee8ea94', '0x6994971f58219cd6', '0x24df10069b430c5e', '0x39065a3f3061caf9', '0x370d54d7a7b92e51', '0x17fb39937bf9140a', '0x6b4edc841976ec4d', '0x309f5b713c74f9c1', '0x66098cdc4b17b913', '0x3635b3a701d4af4d', '0x5b22c759d191d249', '0x37bcf9a9298d5182', '0x165529dd77588465', '0x38820a8f43830869', '0x2b65a467efa8a7ca', '0x2f2e12fc9f82bf3b', '0x14c88a50e323fd1e', '0x2efe5d35f02d6525', '0x1e2deb738bfc56e7', '0x3370948b1e699d61', '0x78d7cbfe63acf7c0', '0x0466761b9cb6e4fc', '0x45dae23b4ad1cff5', '0x5fd6bae68e74d675', '0x53b2cf7135a7e929', '0x459d8fbe36484262', '0x47cfea73c673259b', '0x1af850f9a877bc20', '0x7f658dfe749240d0', '0x0dd83e8b2137fe85', '0x0bec19e791ed361a', '0x6dee0fc47843f8e2', '0x0ed52632777299a8', '0x07823ea0fb5051c8', '0x207d8052d7d1647a', '0x7ed071fb3dc70071', '0x28837c178bc6d475', '0x33404eb1d1d79e1b', '0x2ba8eaa589a42fd9', '0x68583e9671412cf3', '0x749aedf7fc655491', '0x08fe938e983c937e', '0x3287b40643b0877d', '0x67dd155fada74e04', '0x0935b824fad6f7bd', '0x34f26391fdfbd6e1', '0x3b04bf102131d3b1', '0x319da86cc35761b6', '0x757bff791471ce80', '0x65e04ce1ce6f8781', '0x48b4621775b1291e', '0x3b8a420ea878e8d1', '0x6323a743743fad21', '0x6fe6dcb344e2a732', '0x6bd1013f9f8478f7', '0x36cf3e28f89c4c2a', '0x23c6551f187dc724', '0x1d191a49ec032827', '0x1c8b9bb907dacb28', '0x5a314978a4390143', '0x1075411fcfe3c403', '0x2ab12f3114e98917', '0x7fd5bfd0259d4a9e', '0x3ce5c426bdd6065a', '0x5d49334dc6c6775e', '0x5c7552af832a4a28', '0x338a0eb63585bbcd', '0x6179223459c21f5b', '0x02bc91e94ee328a1', '0x434bf2a10ed32c2b', '0x3d21a7b3005ea594', '0x559d8ba0963786ff', '0x2ce3abc0b46be97e', '0x031be3c8e8089204', '0x534e42c7edcf713b', '0x5a6c531345256365', '0x4ab97d180fd93cec', '0x71a8c5197f5ee939', '0x213f65d555c89341', '0x75fe19cbd779ef4f', '0x4a1a387a27c41d95', '0x7448dec889acd355', '0x1a699fa8d109ff50', '0x407cab49fbed98db', '0x29bc7642d9e5bb43', '0x5bfccec5bac35e4e', '0x1b2fe460453bf530', '0x558fbd2d92752dc7', '0x7c3eff823c742883', '0x29bca2e74d7103be', '0x7b0c4815942e50b6', '0x725cae6461e71940', '0x68f5bad77347036c', '0x4523971355e0b8dc', '0x28825af5c113c0c0', '0x6885966bc01ad47c', '0x5626d3febf7765c2', '0x17be1c39a58395e5', '0x5f2ef51b7d3e07a8', '0x0fb767bf6b0768af', '0x19992257b57f7348', '0x3bd099937f64e63a', '0x67ad78bf3ddf99f2', '0x18e956fd1447d1c6', '0x0ea2f2a3f7561245', '0x1c764a7908c37d97', '0x7e333411ffe09257', '0x24ca07d67927779b', '0x5dfbb2df165fc560', '0x3675da3e1fbf1d28', '0x49728e85cb2780f1', '0x6566313e22bb4dd0', '0x7da9d33b944ca909', '0x04c054e5355d8ef8', '0x3452f6f2e64702f0', '0x2eff836445b57b5c', '0x63c2980714ef16ab', '0x024a3bc94b610760', '0x42ee1d5e3ce65909', '0x0ff09c1321f856a5', '0x577e04022a1a56ed', '0x2f9d08be98b0626f', '0x4af097ede65a06f5', '0x1ef57b23adbb3902', '0x08b21c8b7c1df466', '0x5e08cf41235b2a76', '0x6f934247bc6c7143', '0x3c28c917c745ccc1', '0x24700ac0d8260ee3', '0x24b3e42a867595c2', '0x36a11709f532d75b', '0x4295fcec76e8e4d4', '0x58dd432ac8ea291c', '0x4a3e91588f7d5bf1', '0x7ece64b5f37123b2', '0x102b58ec18a9fde9', '0x319e9b54307dbd5b', '0x1b2aa3837f622e0e', '0x1fb928ecc69f7aa6', '0x1a5c7d44d6c5b17b', '0x40edc0160f252491', '0x2ea09ac33a9a9ea3', '0x04bcbb38c1f32614', '0x5f52ca387d4224a5', '0x1d35e3dccd5d62b3', '0x277527ee4148b4e6', '0x50dc96a0290c836f', '0x2c0d38ae1d7f5ecf', '0x7330296f3b24bc2a', '0x4e4f52eee1f86394', '0x382d292f017337d2',
    '0x417502e05fb68cfa', '0x7cce903d0fa27c7e', '0x6c9d1c3a03183e73', '0x1cceeb174423027b', '0x356aa048ecfc19cc', '0x01669e9d1da03009', '0x75836396624a4aa6', '0x15d1826832dd4e43', '0x6f6f4a90062e8769', '0x275a1e42c3588805', '0x330699110891c85f', '0x3cc53ff7349883b5', '0x0e4b67bdccbde5eb', '0x78e04b7d2d44c67c', '0x3345cc4865207eb6', '0x7632f00ee1e58eee', '0x7826b85903e45600', '0x5fc83497a5ca198b', '0x76ee53ccf851c287', '0x35ccca2eab18a708', '0x07558909af175952', '0x41d2149ada8df979', '0x381bc23e2c757243', '0x29404cd68abbf0fe', '0x4e4d222170ab989f', '0x638883126b34bd85', '0x31571d2feed77dbc', '0x7d0330fde4525ad2', '0x07f51ee00e08d0d9', '0x7e85c90c4ba25209', '0x46362fe6735f61d2', '0x222adf0254c64a98', '0x3abcf35c32d26f40', '0x6fb82835d44b306c', '0x0550726ada316ceb', '0x5363abe57788fdb9', '0x44e9ea42909b3907', '0x04466854173430bc', '0x3f1c6f5f03e6b549', '0x2d2a8aa31e3ba520', '0x21d1e1f1405585e6', '0x4969cf491d133ca3', '0x36f795637d48d386', '0x03aaec31555cc5bf', '0x20bbcf0965162f85', '0x0e35593977108e77', '0x6ff2713ef6f6d8a0', '0x60bacbd98246670d', '0x44d05d38e642c824', '0x643eb2776006ef59', '0x77dedb358d36d1c4', '0x61c212ae0730a645', '0x0cbab2bcd226b38d', '0x60c0a1e068b4ed1f', '0x6ffd33b16455e668', '0x4657fe0a81d2b183', '0x52609659263c42c3', '0x4932bf66de13b8db', '0x6c5a83032499602e', '0x1618f69c0f5e08dd', '0x56c060470340ea94', '0x52f73b4a12ce9576', '0x61b968007f5e09c2', '0x466476f590336caa', '0x06a748e5982c563f', '0x1c8cbb045dfe7f8d', '0x392643cf04722b52', '0x511df3ae312d4666', '0x1168cb4c6d25b93b', '0x6f9b3593af5c528a', '0x21d644294400f2c4', '0x141d5806368d23f3', '0x4f0b752066669525', '0x20dc46430f16963a', '0x6dcaab6df28ff26f', '0x2183d7ae734643bb', '0x273fef1ce8e18666', '0x00fd762c300577fb', '0x3cdb40c0d8672d3b', '0x31a6820e0fe09a45', '0x0e259a40c3cb6477', '0x170e4fa1683021db', '0x66dbba50efe991e6', '0x6bf43eb17b4ba4f4', '0x3165853c95c57093', '0x49e53eff9f668336', '0x1cc3d77f96d722b0', '0x7fb7c01aaf277c69', '0x02a61bc4d7ff522c', '0x5e27a0357aa01870', '0x6733d543e56e86bb', '0x05fb529a1a4941bd', '0x099021804bb297a5', '0x4c053666dd13d1ab', '0x44f9e3f31345eb76', '0x0e2e3597670cc499', '0x37b0c85da42a6292', '0x19a00feba079e96a', '0x79437addb95f2dce', '0x534df57aeae2d2c4', '0x5bd3952c8015bcf2', '0x25e442aad013f0a4', '0x28133b32d157e9b1', '0x107b2f7ffd588673', '0x2f96ff2006ee8e98', '0x3df87afa854baf48', '0x70769223ba58ffe9', '0x467b45f252c9666a', '0x0822de4aa3c3ada1', '0x2312c845d8f9e779', '0x75e5b0cb2208c5bc', '0x6d9feb32aef539a9', '0x0f2607b3bf57f877', '0x25e5de5e70be8a1a', '0x78774d9252193693', '0x325e85b9cc075376', '0x5bed3c4ef3890297', '0x021bdcbad8c5b5e8', '0x49bfe67ac5f7c836', '0x3cdcdfdd3217ad12', '0x6011f7db917d0c78', '0x5381986f4178a5f7', '0x65023b57998187cc', '0x42321797554dbe65', '0x475ead0314cdca32', '0x1b62422fb5b4b37b', '0x2779a7e6a462f81d', '0x6d19b57a4671240e', '0x76b72d4e8d34772a', '0x006679140fc6f6da', '0x02d72568b2ba84d1', '0x06e6060fb4ea8d09', '0x4865bc347c80a0e1', '0x2f8c23fac458ee54', '0x092bcfeb5920a139', '0x2f665b4cd8a74c0b', '0x3cf35d5eee905e87', '0x62bc2b7511a0d06c', '0x22f528c2e89f52ad', '0x0489a7375c395b48', '0x4e3b6dd294437f51', '0x0d0b2eb81286a7b0', '0x0508cefc4f2937b5', '0x5c907b90c1c7cef3', '0x506e7f1ce341761d', '0x146763ed2d2e6529', '0x42f23c980b0cee1f', '0x4f58172ae3a7a844', '0x492a5640b1e27177', '0x1e73cc16a49ca147', '0x45d33afb3c84ab51', '0x2b0a6cde1f29d5ec', '0x2e96fc0ffc6be817', '0x58c882c7f9b7ba73', '0x2aafae103c6d6a40', '0x6f579ec3c8b53979', '0x46ad1504277c9705', '0x04e29206d03f7c3c', '0x4012c401e553d688', '0x464a22e752333076', '0x01a50aadfb7952a8', '0x73aac3316ada8d4e', '0x08e7836d29b5449f', '0x111e4ba8fa8c2a38', '0x43640074e19aaf64', '0x42c6c384444da774', '0x38a2beb73af2fe2c', '0x72f3332ad9075693', '0x1d1772a5258c5d99', '0x08d23d5ebac4801e', '0x0f12e133a6426402', '0x27b98fdfe2e96da7', '0x5c3bcb4bf16b52dd', '0x3a1f1cdbd144455f', '0x221080fd9c23ec93', '0x4fb2c716685cb437', '0x32cedb6641d972bc', '0x54bb115f4b5f3b70', '0x24b4d2e7eed29fce', '0x63a06046487cb25f', '0x022a3e2dc7ebabb1', '0x4cc8372e1807d100', '0x51b24653228dc186', '0x78ba4ebbf154dfa1', '0x4d5ef2916ba1f702', '0x235bf542bcd21af5', '0x6f6f35be66411758', '0x4250b9ea08f4bc23', '0x3a2aa64326ce262b', '0x1fd453e4856e2169', '0x605b41da2dabc0a4', '0x24abf92ad6619b04', '0x4dcd7af7152b8b7b', '0x390e83215693fcc6', '0x7861953ba69e9b90', '0x5f11fb64716a7998', '0x00753388ee8dc22a', '0x25d6a59bae37e0c6', '0x155bde2a8a4299c3', '0x27f3ee276162fbe9', '0x036cd9356d02f57e', '0x2e8487f6be3a9081', '0x1fffd24ccec9d4cf', '0x22216cf98bf7e2e0', '0x1c923539d7464130', '0x457a5ac2a8aac739', '0x028eb4272f644b6a', '0x1471081978d24c28', '0x407835c2cd5dc696', '0x4ed60f189db9e416', '0x03eba5baa1a455b1', '0x3cf66a1aa75a6f43', '0x349234b1a11f76f5', '0x2b64a48536bc3d1c', '0x3fcb5d84eea8ce94', '0x6e13c63cf5b398a0', '0x5403c11df53e2285', '0x29671ef928fe2d2f', '0x0e76d776a72ee13e', '0x4978cac6adf4f56d', '0x33cf3c8e28f13d10', '0x2da52776bfedb0f5', '0x62a15e824774fa4e', '0x093bb6fd7a7492a5', '0x66cd2ca4b75cfc42', '0x5cd8ddd75595cc88', '0x677dc7e00e98bb96', '0x58a1248d389e9b19', '0x3e7a0fa105018765', '0x7ade15121110cf5a', '0x30d0be4014cf0fd1', '0x7291524636dcb642', '0x22fc2e045537cd26', '0x26af3611adf0fa7b', '0x7dff8a3f27a5a707', '0x7426f9d9f862ae8e', '0x199b9bd0e583fe38', '0x64f225cc74ef6328', '0x4fce5c798671b920', '0x74dca507324f14dd', '0x501f1db5a38942c3', '0x4f7e0477610d91d5', '0x2f44926267784142', '0x5fd15a25dd4b604c', '0x36d07216484143f7', '0x5fb17493df76761c', '0x69a0dc175c112088', '0x088039a138a9b68a', '0x37c7b66744892263', '0x3d521d81261b782a', '0x15fa6d29b5609a76', '0x10f2f5f77d6c09ef', '0x1c3edc93e61ee216', '0x3f3679317ec1e9ea', '0x3df64ba610f9705d', '0x46f7c9a315947fab', '0x6f0aee5f6325c98f', '0x03e93289230b1ddd', '0x234d63648e154102', '0x7003048c7d3b9fc0', '0x6d331688d7bf46f4', '0x53540bfd8911f95f', '0x1d5f45f98643b37e', '0x5dcf46492a9a5170', '0x54fdfcc7ac66b981', '0x2edc187bd3b14321', '0x5cd520df54a3cb7f', '0x369a54169b3a921e', '0x24917b3155a8d4bd', '0x7b5302bf16d66442', '0x64c2f86b83f20d43', '0x5d7b91f07a581a89', '0x75a55755b75c0dbd', '0x2f2a8d0843fb8581', '0x2a5c6087c478c4e4', '0x1fc02066f15c561e', '0x0f4dbc1a416705d2', '0x547309ef2bff98a2', '0x5d06d61709e68942', '0x29069dd75ae80831', '0x75cfaf91d7abe563', '0x2c1cb8c260fde4ee', '0x38ff3222fa299b4d', '0x54d82c41a9577204', '0x4e7065a51b36b1b8', '0x7507d3301296d1e2', '0x56ad7e61b5514178', '0x0753d717ee6fa590', '0x6580a43cf2d5fa2a', '0x0aaa970a4ebff01d', '0x6aa68f2ecf795381', '0x76dec9c8b16f8b52', '0x40591dc9077c1825', '0x31ad61a39a57b99e', '0x140977d43859306d', '0x4dfc786e935f6b8d', '0x4ae08fdad51ac689', '0x12f7e54330f03b29', '0x107b4cd535c4990b', '0x59a270349eb6be3f', '0x68c67a50258b1db3', '0x12e5c2f6c41993c9', '0x0552f0c7f64e23d8', '0x51891ff0404abfc2', '0x5116dfb580a27cbd', '0x06b2a398335e7152', '0x3769661dac12864d', '0x2c878e386887d596', '0x6b7be424f5dddb14', '0x0899537454751e1f', '0x45bffba1b7db7407', '0x0907ca5c3684c7c5', '0x78a0fa4715cdd314', '0x762e73e0ea2a0fed', '0x2f468ae93a66749d', '0x10bd6a0a22841709', '0x61d2f9cb2498f761', '0x5f3da5bccfd2533d', '0x6bab4a123e95472f', '0x76a69fb3f2667a67', '0x69b985677dbbaa50', '0x569cf053fedef9fc', '0x53d0ceb3dcbe7608', '0x13a2ffd0c217404d', '0x465e8c3c2ddc0f36', '0x5d2719c48a298ff9', '0x351cb6fc17738b94', '0x395c59733d3c7b8f', '0x62e65b145334421b', '0x4cebdc10705f7b05', '0x13543fedbb8e491c', '0x11f13b6dabf6ee18', '0x03ab3ab0f2c8409f', '0x026543a2d99ce786', '0x21105759a58c622d', '0x24de7dd47f36f949', '0x45ac22ec46fb5083', '0x1614a66b12a5a04d', '0x41ae27048a083f89', '0x5ccf82fe2a7d2048', '0x002d26758ddc05f0', '0x26cb5da195b086ee', '0x59fbffe80b130734', '0x44ead3b699b6e262', '0x55a8477aedce14e0', '0x137984bb96e785bd', '0x2231e5b85df11207', '0x1fd6aa22b9e943e0', '0x1f92bf2e1467ad38', '0x4ceb993d7644a877', '0x3d6f5ffd540d9344', '0x1dfda9993afb11c6', '0x234f61bc995e587a', '0x4ddb9f452b9ef784', '0x61ff1d6f6f688f6b', '0x01a985433f18b22f', '0x7a855a488b21cf75', '0x13f818d4853baccf', '0x4aff3a4f1732b76b', '0x593ace56e84aed2b', '0x65a55a6fce208d69', '0x54860b4a35a8895d', '0x5193c4275dc8eac4', '0x681a5e14768e3036', '0x2b93757e2470f17a', '0x044b0eb8649c7c3a', '0x188b88910cd91fdd', '0x4a3920d6a5fb0645', '0x18c0970e64169ee1', '0x45bd4573d425ca4f', '0x4c60824623c8c342', '0x67257b3dbe6b9fad', '0x3d72684e9c80c48f', '0x5bf07bf14257b9c9', '0x29790ed09f6d647a', '0x3270c9aefef24ae1', '0x28bc1e5e7822a208', '0x6d59533a12307a97', '0x5d4db71855cd985d', '0x0decbcabf9ae771e', '0x2e9dc0b49a83b035', '0x5e6e13dbe7778a4d', '0x111dceee2a450aca', '0x2a9673551436468f', '0x73ca3c330024a981', '0x4363cf59a7c2baad', '0x7a99ec1a425bccd3', '0x290f19b17b23f8ad', '0x4c0786715096920c', '0x1b119696a81e6549', '0x5ba17eaa2f72ce71', '0x43d789120297f039', '0x3bac9870147d8c70', '0x461c5f0d9f729171', '0x40b5afa58a17e3d3', '0x4848b9d0fba12782', '0x56b00fb3003180c5', '0x41f7b50c37c911a4', '0x257e92fcfc9872f1', '0x5b79aed783a957c5', '0x6003b14b71649126', '0x54d13325a8fdd104', '0x2391dd4731589976', '0x527b98854cc6694d', '0x5de5df3ebf5896d2', '0x61dae8ae5bea718d', '0x2b9244127d22359e', '0x7aae269574d07699', '0x43ebdbaa620da77d', '0x7581c07e328cc32e', '0x38ffdbc76378cd01', '0x5a827b77c317b86d', '0x31941a9810d507a0', '0x06fc92f010ab4d05', '0x50974993627608e1', '0x53182724901bdc70', '0x6aa0f391e6ee13ea', '0x4d1dd95491b32fac', '0x323212de13b10f10', '0x0b155ab9769c04a4', '0x3dcd799810d160b6', '0x5dec7bb989bdb3f7', '0x62f4e9d7123d96b5', '0x5b2cfc532d3fbee4', '0x75858224d4b6546f', '0x6a598e0447474d20', '0x3fd3f5c7028ce495', '0x5cc8bc52bbad5563', '0x176ed7e46e42e54d', '0x3590cb338abd2a12', '0x4f6d205d42135ef5', '0x3d8c17344449d454', '0x28fd7e20004d35c7', '0x423ee7824ee69e90', '0x61616f09fdfcbb74', '0x6ff357f02f383a3d', '0x4eb1d258cb657cb6', '0x6b600f3f78ead4a1', '0x202975782e75667f', '0x07aa284a5f4472b9', '0x3867a81e9f2e44ad', '0x2e352a97e8b6b490', '0x710c8030ee9287a9', '0x5cc2f3136571226d', '0x5007f73174e69e4e', '0x3d73eb5484317a7b', '0x4cd108ef8b529e1c', '0x17c92581e7c4b817', '0x1ba338fff605288d', '0x1336806a838b83c9', '0x286bcdd53ae1dc34', '0x646ffe74e6413dab', '0x01253f9cc9312297', '0x5b867cd39706825b',
    '0x1aea973263a245ed', '0x3bf796a8bdd5257d', '0x147f99d69dc2fb9a', '0x2b33fedc1f9fb7d7', '0x7e0e4971da016fd1', '0x191a8013cc976a09', '0x70766cc5f4eeb1fa', '0x350e3676cee83288', '0x1d8eb9e81982b027', '0x69dc4cbdba6d84d8', '0x5c0a62ae5641bfcf', '0x543eefc5c5d37be0', '0x63b8fc604d01d0a2', '0x1e2bcf71f93a5413', '0x6d9f7d1e1ca3643e', '0x75b6fec089b2e403', '0x64733f5a6cc5f11b', '0x437f9759cf06fea8', '0x78f5baf0b434e604', '0x39128252a2725685', '0x352cc948d74417cf', '0x36f9621ee8872aa3', '0x553b7df7253d8ec3', '0x1651287ac3f7c978', '0x7345bd9f8e9154f6', '0x4cd060b232def127', '0x3449005444704432', '0x0649cdc2f27da5bc', '0x1999b96ef000568e', '0x3c270cf9fa47b1d4', '0x1e6553130aa51de8', '0x72afb843d27806e8', '0x061393ae509c01a8', '0x7afc1002494e5667', '0x1f3cebe11a693d60', '0x198ee785a63bbcba', '0x13fa70921360c97f', '0x200046c903be9256', '0x3331be4c4a1049ea', '0x76c448707cd41e90', '0x6ea8d7b306dceb0d', '0x5bff3392b5d6a3c0', '0x5da1502f84773118', '0x509e24255aa73a55', '0x1adc608179e036bd', '0x06d1e4ed3358d12f', '0x3260e36fd214508f', '0x296b877f20639262', '0x02656c0852c8be49', '0x11a18edf59ae2ffe', '0x14f0e048f58cb84f', '0x78ec1bebc811cbf6', '0x5d9e3a6e91e32bf6', '0x3d0573d310a33945', '0x31449d92ab6a70be', '0x793c12caf4f9709f', '0x1b267f5b91573a44', '0x002f0fafaf79b194', '0x65fb9455e689b65f', '0x68b097c0b73129c7', '0x7fcd383445ed2add', '0x6a5ba0c8fb0f3bf7', '0x241f63c451aa3e7d', '0x52faa80a749ac4f6', '0x2de8351f141283a1', '0x2679e169ef9323da', '0x02dc64887c54e398', '0x14824af9e8e325f3', '0x73879db147c25d0b', '0x138fa2a4c663dd65', '0x2fc63e5aa044325f', '0x678be5b040e5849b', '0x4112ce9e2259e01a', '0x795a80c489c7570d', '0x323b3e68f03df213', '0x2f0da3acf05e1c8e', '0x2ef9d6e0b4035243', '0x45229921626f4989', '0x0d1a8a745bb960c0', '0x7c2e28debb0aa46c', '0x52b8cae99a855711', '0x2389d3dd84260ba9', '0x3ba0c42783401492', '0x496c5f969867185d', '0x626ec7568e565597', '0x017b7d9bfd256937', '0x54be748378e3bcdd', '0x5295a8e1e1cc9cb1', '0x460e389ee689dd0a', '0x1dd7546189a22719', '0x15c0918604425bee', '0x661d5b73a25ca507', '0x41d618ba29d1e33c', '0x40a57521fb3a59db', '0x54bb702a19a5f82a', '0x5af9bcb47c231f8a', '0x212b37a30fd48fa6', '0x04dd075cefb5b168', '0x65071dbe970c6078', '0x2be3712a14922356', '0x486058e13bcdf3ff', '0x06fb598f47e210ef', '0x35b78e1482baf490', '0x2046348538449e0c', '0x64263698568868e3', '0x250bc3665ef00ba1', '0x67636da49a9f1843', '0x7f67b0f2e6744c4a', '0x30818607d58a4e15', '0x7a810d77111701fa', '0x30e48e88abbf2fbe', '0x5911bc6be4133d02', '0x21bb36aa3e7c44bd', '0x04e82ff6a9a099be', '0x663026eef26137a9', '0x3f167eb81a78444f', '0x193d3b7e725cd163', '0x30c839de760fa84c', '0x607965d93d5030f8', '0x3a79f1d201930503', '0x1d78502f5aaaf892', '0x282ddb1eba3cf466', '0x0a2ba8dccff7d74f', '0x000046ad553f50b7', '0x723481152a8bf5e3', '0x1de7e7b13d483c09', '0x10b058059dcae930', '0x0c42b4dd5dd2b4a7', '0x13bcc300dd5fe994', '0x6f9f9b1b3157c6ce', '0x04c3ab6fe5eff4e1', '0x142cdca39f5642d0', '0x0b445c12175ccadb', '0x4bea7dcb7af44d5a', '0x40f895bcb46725a0', '0x2c0be58934e29f00', '0x0df6db9c54aead51', '0x1cdfa905c63ebe3c', '0x4ff4b4ebe533cd17', '0x0c6301c250643035', '0x0314a652c2aac6b7', '0x084e409669073abc', '0x045d40087eb9eb51', '0x331f59ab31087f91', '0x787d009389fae0e3', '0x20ccfb9366352e34', '0x0de7ec2c07829a52', '0x4b49d1fc78c829f2', '0x2facb17bef9b92c9', '0x1cfcfdba2d8a0ede', '0x059219dd3c4bad02', '0x308ddb3419f9effc', '0x40a37ab07fb0369f', '0x0d5e5408085c3737', '0x6fa792d83ff7deed', '0x03032b1e6e5a121e', '0x305200412ced6f91', '0x7e61e0f6a48c3ffb', '0x156d897538c0b86a', '0x2f14e5e03cc65068', '0x025a295fdfe87c76', '0x691124aec95f9eb5', '0x171a1d5a9fb21490', '0x36d1da2832f88cac', '0x470c1915b7ae202d', '0x4d1e78c517f71fe3', '0x7ed560091a3b2b05', '0x4d41f0bbc9450958', '0x4c812aa9eaadbfc1', '0x1ad1aa358260d70d', '0x279ce687196df556', '0x29dbcd63c7110a01', '0x36b8bc0e1c325c76', '0x1d0ab5510e2db2a5', '0x04eff2326ee24b66', '0x183ff6dcee67f3dd', '0x5cbc22958aebbdd7', '0x0e0d64eae924057c', '0x0fad27889260d63d', '0x61225576f82c7bf8', '0x2e80b5fb3dcb0085', '0x1d7099c546fc081e', '0x442f61cc5164ae8d', '0x1f218a02bae4c07c', '0x0b92a7eb7d792d88', '0x17c60fcc3bb74f0c', '0x6c908b2be5022d7b', '0x72cae61cfb2020f5', '0x2ed9a8266b51ce26', '0x387b5784949e1959', '0x7d896732ec454bb0', '0x662af55d5427630a', '0x29cc7829d2280451', '0x6b3ea41e64cf8cd9', '0x64f50b81b6affaa7', '0x6cb159a6ed79c093', '0x2188e29c88a64c6e', '0x035e1a4594bbacdd', '0x79118ad2ac53ce3c', '0x7d48434c7058feae', '0x3c797f39511cc861', '0x709f91d44226be6c', '0x52c5ff76bdda8124', '0x3be9fc373a2a662d', '0x595831b7e9168ee3', '0x5cc886fd5d32d8b3', '0x5253827afbc84e22', '0x2f01e574e2f33342', '0x20b4b0bcb3622972', '0x4182f9d9d5882b55', '0x7732317e0d9dff7f', '0x773cf488f38ce010', '0x269c308f19bec38a', '0x02ac4943552acfaf', '0x5c8d8c36cf248be3', '0x76a48ea3f5d23fe2', '0x6f3af7ea117d86dc', '0x3aaf4559a315bad5', '0x65281e568d17055b', '0x3bc689cd2539e548', '0x64687f749e92b4ff', '0x41cbd2ddeb22baf6', '0x492fd3c47ed112b9', '0x2f35dbd4306bea96', '0x4654ac1378f12e94', '0x71c420191b6bf8fc', '0x0635caf1051ab3e4', '0x7944e3b047fb4e8f', '0x63063372a4b601a7', '0x2c860002f4131e4e', '0x1ae3d93910d6300d', '0x61517befd9aa5bb7', '0x08adfe91e4ab257d', '0x5ebbbc98d863761d', '0x382f782aa1ab8fd8', '0x475be2940fe554bc', '0x43dec43580208b40', '0x6176d0dc85074c56', '0x5894523d74fe6a67', '0x4cd3657e506acd07', '0x0567e44b6aa8fbb7', '0x36d4e1f17e7fd145', '0x58a64e2c5635fa66', '0x362a1248a773bd30', '0x752a1669a8520846']

MDS_matrix = [['0x2fffffffffffffff', '0x647ac8f591eb23d7', '0x674e9d3a74e9d3a6', '0x38e38e38e38e38e3', '0x16db6db6db6db6db', '0x468d1a3468d1a347', '0x7333333333333332', '0x4a5294a5294a5295', '0x7c00000000000001', '0x39ce739ce739ce73', '0x2eeeeeeeeeeeeeee', '0x4232be1195f08cae', '0x7249249249249248', '0x04b3e3750967c6ea', '0x1789af135e26bc4d', '0x3d84f613d84f613d', '0x6555555555555554', '0x05763e690aec7cd2', '0x39e79e79e79e79e7', '0x5c29b85370a6e14c', '0x52e5cb972e5cb973', '0x17a17a17a17a17a1', '0x22c58b162c58b162', '0x05a8ef930b51df26'],
    ['0x647ac8f591eb23d7', '0x2fffffffffffffff', '0x38e38e38e38e38e3', '0x674e9d3a74e9d3a6', '0x468d1a3468d1a347', '0x16db6db6db6db6db', '0x4a5294a5294a5295', '0x7333333333333332', '0x39ce739ce739ce73', '0x7c00000000000001', '0x4232be1195f08cae', '0x2eeeeeeeeeeeeeee', '0x04b3e3750967c6ea', '0x7249249249249248', '0x3d84f613d84f613d', '0x1789af135e26bc4d', '0x05763e690aec7cd2', '0x6555555555555554', '0x5c29b85370a6e14c', '0x39e79e79e79e79e7', '0x17a17a17a17a17a1', '0x52e5cb972e5cb973', '0x05a8ef930b51df26', '0x22c58b162c58b162'],
    ['0x674e9d3a74e9d3a6', '0x38e38e38e38e38e3', '0x2fffffffffffffff', '0x647ac8f591eb23d7', '0x7333333333333332', '0x4a5294a5294a5295', '0x16db6db6db6db6db', '0x468d1a3468d1a347', '0x2eeeeeeeeeeeeeee', '0x4232be1195f08cae', '0x7c00000000000001', '0x39ce739ce739ce73', '0x1789af135e26bc4d', '0x3d84f613d84f613d', '0x7249249249249248', '0x04b3e3750967c6ea', '0x39e79e79e79e79e7', '0x5c29b85370a6e14c', '0x6555555555555554', '0x05763e690aec7cd2', '0x22c58b162c58b162', '0x05a8ef930b51df26', '0x52e5cb972e5cb973', '0x17a17a17a17a17a1'],
    ['0x38e38e38e38e38e3', '0x674e9d3a74e9d3a6', '0x647ac8f591eb23d7', '0x2fffffffffffffff', '0x4a5294a5294a5295', '0x7333333333333332', '0x468d1a3468d1a347', '0x16db6db6db6db6db', '0x4232be1195f08cae', '0x2eeeeeeeeeeeeeee', '0x39ce739ce739ce73', '0x7c00000000000001', '0x3d84f613d84f613d', '0x1789af135e26bc4d', '0x04b3e3750967c6ea', '0x7249249249249248', '0x5c29b85370a6e14c', '0x39e79e79e79e79e7', '0x05763e690aec7cd2', '0x6555555555555554', '0x05a8ef930b51df26', '0x22c58b162c58b162', '0x17a17a17a17a17a1', '0x52e5cb972e5cb973'],
    ['0x16db6db6db6db6db', '0x468d1a3468d1a347', '0x7333333333333332', '0x4a5294a5294a5295', '0x2fffffffffffffff', '0x647ac8f591eb23d7', '0x674e9d3a74e9d3a6', '0x38e38e38e38e38e3', '0x7249249249249248', '0x04b3e3750967c6ea', '0x1789af135e26bc4d', '0x3d84f613d84f613d', '0x7c00000000000001', '0x39ce739ce739ce73', '0x2eeeeeeeeeeeeeee', '0x4232be1195f08cae', '0x52e5cb972e5cb973', '0x17a17a17a17a17a1', '0x22c58b162c58b162', '0x05a8ef930b51df26', '0x6555555555555554', '0x05763e690aec7cd2', '0x39e79e79e79e79e7', '0x5c29b85370a6e14c'],
    ['0x468d1a3468d1a347', '0x16db6db6db6db6db', '0x4a5294a5294a5295', '0x7333333333333332', '0x647ac8f591eb23d7', '0x2fffffffffffffff', '0x38e38e38e38e38e3', '0x674e9d3a74e9d3a6', '0x04b3e3750967c6ea', '0x7249249249249248', '0x3d84f613d84f613d', '0x1789af135e26bc4d', '0x39ce739ce739ce73', '0x7c00000000000001', '0x4232be1195f08cae', '0x2eeeeeeeeeeeeeee', '0x17a17a17a17a17a1', '0x52e5cb972e5cb973', '0x05a8ef930b51df26', '0x22c58b162c58b162', '0x05763e690aec7cd2', '0x6555555555555554', '0x5c29b85370a6e14c', '0x39e79e79e79e79e7'],
    ['0x7333333333333332', '0x4a5294a5294a5295', '0x16db6db6db6db6db', '0x468d1a3468d1a347', '0x674e9d3a74e9d3a6', '0x38e38e38e38e38e3', '0x2fffffffffffffff', '0x647ac8f591eb23d7', '0x1789af135e26bc4d', '0x3d84f613d84f613d', '0x7249249249249248', '0x04b3e3750967c6ea', '0x2eeeeeeeeeeeeeee', '0x4232be1195f08cae', '0x7c00000000000001', '0x39ce739ce739ce73', '0x22c58b162c58b162', '0x05a8ef930b51df26', '0x52e5cb972e5cb973', '0x17a17a17a17a17a1', '0x39e79e79e79e79e7', '0x5c29b85370a6e14c', '0x6555555555555554', '0x05763e690aec7cd2'],
    ['0x4a5294a5294a5295', '0x7333333333333332', '0x468d1a3468d1a347', '0x16db6db6db6db6db', '0x38e38e38e38e38e3', '0x674e9d3a74e9d3a6', '0x647ac8f591eb23d7', '0x2fffffffffffffff', '0x3d84f613d84f613d', '0x1789af135e26bc4d', '0x04b3e3750967c6ea', '0x7249249249249248', '0x4232be1195f08cae', '0x2eeeeeeeeeeeeeee', '0x39ce739ce739ce73', '0x7c00000000000001', '0x05a8ef930b51df26', '0x22c58b162c58b162', '0x17a17a17a17a17a1', '0x52e5cb972e5cb973', '0x5c29b85370a6e14c', '0x39e79e79e79e79e7', '0x05763e690aec7cd2', '0x6555555555555554'],
    ['0x7800000000000001', '0x5ddddddddddddddc', '0x6492492492492493', '0x2f135e26bc4d789a', '0x4aaaaaaaaaaaaaab', '0x73cf3cf3cf3cf3ce', '0x25cb972e5cb972e5', '0x458b162c58b162c4', '0x6555555555555554', '0x05763e690aec7cd2', '0x39e79e79e79e79e7', '0x5c29b85370a6e14c', '0x52e5cb972e5cb973', '0x17a17a17a17a17a1', '0x22c58b162c58b162', '0x05a8ef930b51df26', '0x7c00000000000001', '0x39ce739ce739ce73', '0x2eeeeeeeeeeeeeee', '0x4232be1195f08cae', '0x7249249249249248', '0x04b3e3750967c6ea', '0x1789af135e26bc4d', '0x3d84f613d84f613d'],
    ['0x5ddddddddddddddc', '0x7800000000000001', '0x2f135e26bc4d789a', '0x6492492492492493', '0x73cf3cf3cf3cf3ce', '0x4aaaaaaaaaaaaaab', '0x458b162c58b162c4', '0x25cb972e5cb972e5', '0x05763e690aec7cd2', '0x6555555555555554', '0x5c29b85370a6e14c', '0x39e79e79e79e79e7', '0x17a17a17a17a17a1', '0x52e5cb972e5cb973', '0x05a8ef930b51df26', '0x22c58b162c58b162', '0x39ce739ce739ce73', '0x7c00000000000001', '0x4232be1195f08cae', '0x2eeeeeeeeeeeeeee', '0x04b3e3750967c6ea', '0x7249249249249248', '0x3d84f613d84f613d', '0x1789af135e26bc4d'],
    ['0x6492492492492493', '0x2f135e26bc4d789a', '0x7800000000000001', '0x5ddddddddddddddc', '0x25cb972e5cb972e5', '0x458b162c58b162c4', '0x4aaaaaaaaaaaaaab', '0x73cf3cf3cf3cf3ce', '0x39e79e79e79e79e7', '0x5c29b85370a6e14c', '0x6555555555555554', '0x05763e690aec7cd2', '0x22c58b162c58b162', '0x05a8ef930b51df26', '0x52e5cb972e5cb973', '0x17a17a17a17a17a1', '0x2eeeeeeeeeeeeeee', '0x4232be1195f08cae', '0x7c00000000000001', '0x39ce739ce739ce73', '0x1789af135e26bc4d', '0x3d84f613d84f613d', '0x7249249249249248', '0x04b3e3750967c6ea'],
    ['0x2f135e26bc4d789a', '0x6492492492492493', '0x5ddddddddddddddc', '0x7800000000000001', '0x458b162c58b162c4', '0x25cb972e5cb972e5', '0x73cf3cf3cf3cf3ce', '0x4aaaaaaaaaaaaaab', '0x5c29b85370a6e14c', '0x39e79e79e79e79e7', '0x05763e690aec7cd2', '0x6555555555555554', '0x05a8ef930b51df26', '0x22c58b162c58b162', '0x17a17a17a17a17a1', '0x52e5cb972e5cb973', '0x4232be1195f08cae', '0x2eeeeeeeeeeeeeee', '0x39ce739ce739ce73', '0x7c00000000000001', '0x3d84f613d84f613d', '0x1789af135e26bc4d', '0x04b3e3750967c6ea', '0x7249249249249248'],
    ['0x4aaaaaaaaaaaaaab', '0x73cf3cf3cf3cf3ce', '0x25cb972e5cb972e5', '0x458b162c58b162c4', '0x7800000000000001', '0x5ddddddddddddddc', '0x6492492492492493', '0x2f135e26bc4d789a', '0x52e5cb972e5cb973', '0x17a17a17a17a17a1', '0x22c58b162c58b162', '0x05a8ef930b51df26', '0x6555555555555554', '0x05763e690aec7cd2', '0x39e79e79e79e79e7', '0x5c29b85370a6e14c', '0x7249249249249248', '0x04b3e3750967c6ea', '0x1789af135e26bc4d', '0x3d84f613d84f613d', '0x7c00000000000001', '0x39ce739ce739ce73', '0x2eeeeeeeeeeeeeee', '0x4232be1195f08cae'],
    ['0x73cf3cf3cf3cf3ce', '0x4aaaaaaaaaaaaaab', '0x458b162c58b162c4', '0x25cb972e5cb972e5', '0x5ddddddddddddddc', '0x7800000000000001', '0x2f135e26bc4d789a', '0x6492492492492493', '0x17a17a17a17a17a1', '0x52e5cb972e5cb973', '0x05a8ef930b51df26', '0x22c58b162c58b162', '0x05763e690aec7cd2', '0x6555555555555554', '0x5c29b85370a6e14c', '0x39e79e79e79e79e7', '0x04b3e3750967c6ea', '0x7249249249249248', '0x3d84f613d84f613d', '0x1789af135e26bc4d', '0x39ce739ce739ce73', '0x7c00000000000001', '0x4232be1195f08cae', '0x2eeeeeeeeeeeeeee'],
    ['0x25cb972e5cb972e5', '0x458b162c58b162c4', '0x4aaaaaaaaaaaaaab', '0x73cf3cf3cf3cf3ce', '0x6492492492492493', '0x2f135e26bc4d789a', '0x7800000000000001', '0x5ddddddddddddddc', '0x22c58b162c58b162', '0x05a8ef930b51df26', '0x52e5cb972e5cb973', '0x17a17a17a17a17a1', '0x39e79e79e79e79e7', '0x5c29b85370a6e14c', '0x6555555555555554', '0x05763e690aec7cd2', '0x1789af135e26bc4d', '0x3d84f613d84f613d', '0x7249249249249248', '0x04b3e3750967c6ea', '0x2eeeeeeeeeeeeeee', '0x4232be1195f08cae', '0x7c00000000000001', '0x39ce739ce739ce73'],
    ['0x458b162c58b162c4', '0x25cb972e5cb972e5', '0x73cf3cf3cf3cf3ce', '0x4aaaaaaaaaaaaaab', '0x2f135e26bc4d789a', '0x6492492492492493', '0x5ddddddddddddddc', '0x7800000000000001', '0x05a8ef930b51df26', '0x22c58b162c58b162', '0x17a17a17a17a17a1', '0x52e5cb972e5cb973', '0x5c29b85370a6e14c', '0x39e79e79e79e79e7', '0x05763e690aec7cd2', '0x6555555555555554', '0x3d84f613d84f613d', '0x1789af135e26bc4d', '0x04b3e3750967c6ea', '0x7249249249249248', '0x4232be1195f08cae', '0x2eeeeeeeeeeeeeee', '0x39ce739ce739ce73', '0x7c00000000000001'],
    ['0x7000000000000001', '0x4924924924924925', '0x1555555555555555', '0x4b972e5cb972e5ca', '0x5ffffffffffffffe', '0x4e9d3a74e9d3a74f', '0x2db6db6db6db6db6', '0x6666666666666667', '0x57fffffffffffffe', '0x43ea621f5310fa99', '0x723d647ac8f591ea', '0x34b4b4b4b4b4b4b4', '0x33a74e9d3a74e9d3', '0x650eca1d943b2877', '0x5c71c71c71c71c70', '0x0737d12b0e6fa256', '0x4b6db6db6db6db6c', '0x3c86f21bc86f21bc', '0x63468d1a3468d1a2', '0x06a45f670d48bece', '0x3999999999999999', '0x064fb8ad0c9f715a', '0x65294a5294a5294b', '0x2ebaebaebaebaeba'],
    ['0x4924924924924925', '0x7000000000000001', '0x4b972e5cb972e5ca', '0x1555555555555555', '0x4e9d3a74e9d3a74f', '0x5ffffffffffffffe', '0x6666666666666667', '0x2db6db6db6db6db6', '0x43ea621f5310fa99', '0x57fffffffffffffe', '0x34b4b4b4b4b4b4b4', '0x723d647ac8f591ea', '0x650eca1d943b2877', '0x33a74e9d3a74e9d3', '0x0737d12b0e6fa256', '0x5c71c71c71c71c70', '0x3c86f21bc86f21bc', '0x4b6db6db6db6db6c', '0x06a45f670d48bece', '0x63468d1a3468d1a2', '0x064fb8ad0c9f715a', '0x3999999999999999', '0x2ebaebaebaebaeba', '0x65294a5294a5294b'],
    ['0x1555555555555555', '0x4b972e5cb972e5ca', '0x7000000000000001', '0x4924924924924925', '0x2db6db6db6db6db6', '0x6666666666666667', '0x5ffffffffffffffe', '0x4e9d3a74e9d3a74f', '0x723d647ac8f591ea', '0x34b4b4b4b4b4b4b4', '0x57fffffffffffffe', '0x43ea621f5310fa99', '0x5c71c71c71c71c70', '0x0737d12b0e6fa256', '0x33a74e9d3a74e9d3', '0x650eca1d943b2877', '0x63468d1a3468d1a2', '0x06a45f670d48bece', '0x4b6db6db6db6db6c', '0x3c86f21bc86f21bc', '0x65294a5294a5294b', '0x2ebaebaebaebaeba', '0x3999999999999999', '0x064fb8ad0c9f715a'],
    ['0x4b972e5cb972e5ca', '0x1555555555555555', '0x4924924924924925', '0x7000000000000001', '0x6666666666666667', '0x2db6db6db6db6db6', '0x4e9d3a74e9d3a74f', '0x5ffffffffffffffe', '0x34b4b4b4b4b4b4b4', '0x723d647ac8f591ea', '0x43ea621f5310fa99', '0x57fffffffffffffe', '0x0737d12b0e6fa256', '0x5c71c71c71c71c70', '0x650eca1d943b2877', '0x33a74e9d3a74e9d3', '0x06a45f670d48bece', '0x63468d1a3468d1a2', '0x3c86f21bc86f21bc', '0x4b6db6db6db6db6c', '0x2ebaebaebaebaeba', '0x65294a5294a5294b', '0x064fb8ad0c9f715a', '0x3999999999999999'],
    ['0x5ffffffffffffffe', '0x4e9d3a74e9d3a74f', '0x2db6db6db6db6db6', '0x6666666666666667', '0x7000000000000001', '0x4924924924924925', '0x1555555555555555', '0x4b972e5cb972e5ca', '0x33a74e9d3a74e9d3', '0x650eca1d943b2877', '0x5c71c71c71c71c70', '0x0737d12b0e6fa256', '0x57fffffffffffffe', '0x43ea621f5310fa99', '0x723d647ac8f591ea', '0x34b4b4b4b4b4b4b4', '0x3999999999999999', '0x064fb8ad0c9f715a', '0x65294a5294a5294b', '0x2ebaebaebaebaeba', '0x4b6db6db6db6db6c', '0x3c86f21bc86f21bc', '0x63468d1a3468d1a2', '0x06a45f670d48bece'],
    ['0x4e9d3a74e9d3a74f', '0x5ffffffffffffffe', '0x6666666666666667', '0x2db6db6db6db6db6', '0x4924924924924925', '0x7000000000000001', '0x4b972e5cb972e5ca', '0x1555555555555555', '0x650eca1d943b2877', '0x33a74e9d3a74e9d3', '0x0737d12b0e6fa256', '0x5c71c71c71c71c70', '0x43ea621f5310fa99', '0x57fffffffffffffe', '0x34b4b4b4b4b4b4b4', '0x723d647ac8f591ea', '0x064fb8ad0c9f715a', '0x3999999999999999', '0x2ebaebaebaebaeba', '0x65294a5294a5294b', '0x3c86f21bc86f21bc', '0x4b6db6db6db6db6c', '0x06a45f670d48bece', '0x63468d1a3468d1a2'],
    ['0x2db6db6db6db6db6', '0x6666666666666667', '0x5ffffffffffffffe', '0x4e9d3a74e9d3a74f', '0x1555555555555555', '0x4b972e5cb972e5ca', '0x7000000000000001', '0x4924924924924925', '0x5c71c71c71c71c70', '0x0737d12b0e6fa256', '0x33a74e9d3a74e9d3', '0x650eca1d943b2877', '0x723d647ac8f591ea', '0x34b4b4b4b4b4b4b4', '0x57fffffffffffffe', '0x43ea621f5310fa99', '0x65294a5294a5294b', '0x2ebaebaebaebaeba', '0x3999999999999999', '0x064fb8ad0c9f715a', '0x63468d1a3468d1a2', '0x06a45f670d48bece', '0x4b6db6db6db6db6c', '0x3c86f21bc86f21bc'],
    ['0x6666666666666667', '0x2db6db6db6db6db6', '0x4e9d3a74e9d3a74f', '0x5ffffffffffffffe', '0x4b972e5cb972e5ca', '0x1555555555555555', '0x4924924924924925', '0x7000000000000001', '0x0737d12b0e6fa256', '0x5c71c71c71c71c70', '0x650eca1d943b2877', '0x33a74e9d3a74e9d3', '0x34b4b4b4b4b4b4b4', '0x723d647ac8f591ea', '0x43ea621f5310fa99', '0x57fffffffffffffe', '0x2ebaebaebaebaeba', '0x65294a5294a5294b', '0x064fb8ad0c9f715a', '0x3999999999999999', '0x06a45f670d48bece', '0x63468d1a3468d1a2', '0x3c86f21bc86f21bc', '0x4b6db6db6db6db6c']]

MDS_matrix_field = matrix(F, t, t)
for i in range(0, t):
    for j in range(0, t):
        MDS_matrix_field[i, j] = F.fetch_int(int(MDS_matrix[i][j], 16))
round_constants_field = []
for i in range(0, (R_F + R_P) * t):
    round_constants_field.append(F.fetch_int(int(round_constants[i], 16)))

def print_words_to_hex(words):
    hex_length = int(ceil(float(n) / 4)) + 2 # +2 for "0x"
    print ["{0:#0{1}x}".format(entry.integer_representation(), hex_length) for entry in words]

def concat_words_to_large(words):
    int_concat = 0
    for i in range(0, t):
        int_concat |= ((words[i]).integer_representation() << (n * i))
    return int_concat

def perm(input_words):

    R_f = int(R_F / 2)

    round_constants_counter = 0

    state_words = list(input_words)

    # First full rounds
    for r in range(0, R_f):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^3
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Middle partial rounds
    for r in range(0, R_P):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        state_words[0] = (state_words[0])^3
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Last-1 full rounds (no matrix multiplication at last round)
    for r in range(0, R_f - 1):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^3
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Last round (no matrix multiplication)
    # Round constants, nonlinear layer
    for i in range(0, t):
        state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
        round_constants_counter += 1
    for i in range(0, t):
        state_words[i] = (state_words[i])^3
    
    return state_words

input_words = []
for i in range(0, t):
    input_words.append(F.fetch_int(i))

output_words = perm(input_words)

print "Input:"
print_words_to_hex(input_words)
print "Output:"
print_words_to_hex(output_words)

print "Input (concat):"
print "0x" + hex(concat_words_to_large(input_words))
print "Output (concat):"
print "0x" + hex(concat_words_to_large(output_words))
